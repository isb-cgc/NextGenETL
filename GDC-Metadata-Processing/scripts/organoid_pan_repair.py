"""

Copyright 2020, Institute for Systems Biology

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

"""

import sys
import csv

'''
----------------------------------------------------------------------------------------------
ORGANOID-PANCREATIC results from GDC API before and including Rel22 have problems with
aliquot IDs in case endpoint. Repair the TSV file.
'''

repairs = \
'''
associated_entities__entity_submitter_id	case_gdc_id	associated_entities__entity_gdc_id
ALIQUOT1	f5393eea-abad-4f59-a19d-4ac65bd0ad65	b4352279-0f5a-4c8f-b1d4-5f9bdf690d1c
ALIQUOT10	490344a3-9367-42cb-b109-8562eed90bdf	07c0ca7e-a9ba-4573-bd8a-cbf73d650cbb
ALIQUOT100	5ff50c23-54c5-4296-a164-1160cfa629c4	f28cbec0-071a-41bf-94e0-4fdbe02742c3
ALIQUOT101	670dc6a3-d40a-4283-8e99-c847d33b5099	1c854b02-e522-4db8-b223-a4232639a8e7
ALIQUOT102	08f63445-b236-4f97-b76a-2e5f4b3c5ff5	d297ed12-246b-4d5c-8e84-3cee2555a6a9
ALIQUOT103	63f87552-091c-4c27-bce0-a37e6657777f	3ed592f4-13c2-4498-9266-65e43b0d9594
ALIQUOT104	aaece851-ced6-4816-9cf2-2fa506f2bc79	a2001ffb-a0c9-4636-9438-4e2857e70d4c
ALIQUOT105	fdd01339-fd45-47e6-9d68-b2ab126d5ee9	ab0ae557-f915-41f4-a6ba-bc1def70d425
ALIQUOT106	b6a1561a-97ee-4f64-b417-391ccc08f707	a80a0a9f-0f13-44fe-a99a-674a37a6bd40
ALIQUOT107	ece88485-dae8-4f8e-b922-e2c6f8bffd7c	7a310be2-73f3-49db-b1c1-7b887fbc11d4
ALIQUOT108	d7ac181d-ce1b-4672-953e-aeff29615636	be0b9a27-f568-4f45-8cc7-cc3f9da99d45
ALIQUOT109	789c341c-8797-4253-8bf9-93638c4d7de6	11748118-4168-4894-b7ff-b9106ec56614
ALIQUOT11	490344a3-9367-42cb-b109-8562eed90bdf	447c5e81-47e2-43e3-9c9f-1221152c1ac8
ALIQUOT110	f3aa1797-24fc-4fd1-a9f0-35acbc767562	548a8510-1214-499f-916e-f410fef67d5d
ALIQUOT111	e5cdafdf-d896-47e8-8de1-c27a3eeb4db8	8a4d7bd5-3943-4121-a566-ec33c99f5a3a
ALIQUOT112	3e32e738-6c3c-413f-bb2b-8ab62b55c57c	07796e8b-1705-49c1-9b1b-1a0df4aac8af
ALIQUOT113	5d324f9f-87ce-454d-bfcd-2d7e38d52e92	9caa4f22-a1f8-4f9e-b4b1-40f6f1088965
ALIQUOT114	c0ef776f-0d31-4a6d-aab3-ae952c7da81b	da56c653-3033-424b-be66-c345b516239a
ALIQUOT116	34515919-3925-4349-ac41-2dabd824af90	d67676be-caeb-4f20-a8f1-cbb7143e1860
ALIQUOT117	d0f95cba-73ac-4243-b530-e7427f9342f7	af01e56b-8074-43ae-98e7-f37f8d953861
ALIQUOT118	e7b173c2-b03c-4da3-9f20-59f922bb4f50	2e187896-d564-48e1-ab54-7b39f3730844
ALIQUOT12	e3fcb486-9525-40b1-bd3e-802bc8ae770c	495bad18-cfda-44f2-8bcf-b9a4f482f14e
ALIQUOT122	57aeef7a-e0c6-4e53-90ce-c213c5263544	f866f0bf-6134-42a3-8227-6c5e4524580e
ALIQUOT123	512b6cff-e920-4b1e-86cf-e1826448c6fe	1d5255f2-e60a-4f97-99e2-d50edbe5346f
ALIQUOT125	ff87de39-5f94-4706-8d87-1aad2525874e	6244299f-2dfa-46e5-8d1b-c3169dab5ca7
ALIQUOT126	404d6e37-0e62-4632-a57c-a2c0c8fb55b2	9814d46d-1cd8-41ca-bda0-5e52975d0f3e
ALIQUOT127	517dddac-a8a0-44a4-b9af-f619f4eadefd	88eb889c-f714-4df6-8613-34fd1ecf6a22
ALIQUOT128	9c5b064f-99bd-4178-ad75-2b98c61c761c	c759776d-9659-4ac6-b3db-426c20fc74c1
ALIQUOT129	0b2618b5-3ece-4655-b4ed-ed4b51ab6702	aa9ad21b-8508-4a3b-91fb-977a45ffa730
ALIQUOT13	e3fcb486-9525-40b1-bd3e-802bc8ae770c	7723c435-5a4f-43ee-a8cc-645f4a4d816e
ALIQUOT130	4d8466c3-dcb1-491b-9856-b68cf8226648	bd51467e-6f76-4939-9ff4-abf2b28d13cb
ALIQUOT131	668518ae-43b6-4daf-85e8-20f3a512027c	7eb90f3d-1da7-42f8-bd27-83a37f140388
ALIQUOT132	d23611c6-d8d3-4af8-a394-8bb2b48c13ee	2f965241-8c39-48b0-b726-7a36c17d36c2
ALIQUOT133	d277d0dd-4be9-484f-ba57-2d9ac16c6736	322305eb-6f5a-4cca-a9e6-701569a62b08
ALIQUOT134	1e76c9e9-d710-4fed-a793-0ffb60293b51	6a2eac11-274b-4723-867b-c0f4335eac57
ALIQUOT135	c9d50190-5241-4021-b885-b4e983ba3a4b	2b8becf5-140f-4fca-aa13-c3d739e73f18
ALIQUOT136	ad6f1cc8-b339-454e-ba88-bf4b1a5f27c9	bbc4c736-bfe3-43c8-9081-d098dc13e4ce
ALIQUOT14	e3fcb486-9525-40b1-bd3e-802bc8ae770c	e23427bb-b188-462b-add0-2a94ec14791e
ALIQUOT144	11f1276f-d829-43ff-b519-81e994e2e4fe	9f653f74-b8fb-4764-b1fb-3f01b08ecd7c
ALIQUOT145	6bec9fdd-64f1-4cf4-90e6-8a3610a6b641	def0c284-e6bd-431e-b416-84e5e34f59a5
ALIQUOT146	48d75984-fa80-49cf-80b5-c8f431088ad7	9158797b-fe6d-41d5-9a21-7b1a194bafbd
ALIQUOT148	cf5c26cb-5a53-4663-bf10-a8ac74749569	3de91327-5ac9-475e-b1d8-3b19cac19006
ALIQUOT149	f15e79b7-52b4-44df-8ddb-b3bbc65c50b3	3de260fd-0911-4712-a352-34c24c57a2a9
ALIQUOT15	d844bb04-7102-44d8-989d-e412339d7d48	6bfd6a9d-f6bc-4134-a029-45d1d600f770
ALIQUOT150	f15e79b7-52b4-44df-8ddb-b3bbc65c50b3	3c5812e3-8640-4eae-bf2c-b01bbad90a27
ALIQUOT151	8e86e075-f718-4173-9d1e-a6c47fce1528	2307bacf-9d54-482a-98f5-82be7286a46c
ALIQUOT152	e3fcb486-9525-40b1-bd3e-802bc8ae770c	19041ee7-d658-487c-acd0-0e6b99e35a2f
ALIQUOT153	d844bb04-7102-44d8-989d-e412339d7d48	fc6cf2ce-1ad8-4aa2-bc7c-d2e849249f9a
ALIQUOT156	12624089-ba56-4402-a9b5-ab2cc653dfad	4081894f-9d4e-4da0-b678-be4b8a20279e
ALIQUOT157	d7f95afc-d9d9-497e-b7ba-cdaec4d300b4	b3347ecb-f4df-4c01-bad2-6555a7cb3416
ALIQUOT158	670dc6a3-d40a-4283-8e99-c847d33b5099	9b99882b-4c92-4b4f-9ff6-acea9b14112c
ALIQUOT159	fdd01339-fd45-47e6-9d68-b2ab126d5ee9	bcde3cce-eaf9-4cf5-ad19-cb65746c5198
ALIQUOT16	d844bb04-7102-44d8-989d-e412339d7d48	a4d8d755-f619-49cb-a3aa-b46e513dfdb5
ALIQUOT160	789c341c-8797-4253-8bf9-93638c4d7de6	bf4de7fe-6a77-4b12-8e9f-a1910d476aec
ALIQUOT161	4d8466c3-dcb1-491b-9856-b68cf8226648	c17276be-9ec5-4d7f-941e-da3187d29db8
ALIQUOT163	e3fcb486-9525-40b1-bd3e-802bc8ae770c	b570dfbd-893b-4876-a5b5-34584de9318f
ALIQUOT165	f5393eea-abad-4f59-a19d-4ac65bd0ad65	dac606b9-3cb9-4b40-949f-b0e05ee8a702
ALIQUOT166	490344a3-9367-42cb-b109-8562eed90bdf	d4c96a44-7241-4b51-93a2-ec8d72e2a835
ALIQUOT168	5ff50c23-54c5-4296-a164-1160cfa629c4	eba3997a-0bc2-4b7d-9767-e6f729062dcd
ALIQUOT169	63f87552-091c-4c27-bce0-a37e6657777f	c2bec430-9300-43c2-adf4-c6d7e255c170
ALIQUOT17	d844bb04-7102-44d8-989d-e412339d7d48	3c02790c-4976-4df6-909b-2e10f6683ca1
ALIQUOT170	ece88485-dae8-4f8e-b922-e2c6f8bffd7c	a91f8c51-3811-47af-bf6b-ae3d144145a8
ALIQUOT171	668518ae-43b6-4daf-85e8-20f3a512027c	f8ee1477-7188-499d-b2ef-36eedd5fd20a
ALIQUOT172	c9d50190-5241-4021-b885-b4e983ba3a4b	d7e7a2a2-0999-4ddd-9319-1181ae7cddd2
ALIQUOT173	11f1276f-d829-43ff-b519-81e994e2e4fe	35d74c85-e3da-4a2f-b894-f0c65d1960d8
ALIQUOT175	cecdd55a-4d5c-4050-8ff5-b89305078289	cf62ed4a-3f47-42d0-bfdd-0a4c8201339e
ALIQUOT176	0199d671-0b2d-4673-9a3a-8df12e0a17cd	b33fb1ae-a76b-4c33-bc35-1d5b9dcc4567
ALIQUOT179	5cba90b4-5473-4826-a945-c50f2663e252	40c65730-04ae-4ad3-b2ce-112e95485088
ALIQUOT18	11f1276f-d829-43ff-b519-81e994e2e4fe	a989ab29-dad6-4dec-b8f8-78b8ab9bd2b7
ALIQUOT180	f7a6e992-9f97-4387-85c6-18da46a97aac	cc4f3798-b317-4d38-a064-47130ad60ba8
ALIQUOT181	08f63445-b236-4f97-b76a-2e5f4b3c5ff5	f31e9cd6-1222-416c-ba93-65f5f8a9d883
ALIQUOT182	b6a1561a-97ee-4f64-b417-391ccc08f707	f2eb0b94-416f-453f-8aa0-f62953d5edfb
ALIQUOT183	9c5b064f-99bd-4178-ad75-2b98c61c761c	5025e7b4-05d5-4c88-a5a9-ae19956f55da
ALIQUOT184	d277d0dd-4be9-484f-ba57-2d9ac16c6736	dac03cc4-5ca5-4eed-bbd2-01faea9b5f19
ALIQUOT186	d844bb04-7102-44d8-989d-e412339d7d48	a4d7274d-4d91-4a4e-999d-72018b3171c8
ALIQUOT187	c12aeeeb-8b99-45cf-b41b-66d790da3f20	c46603c9-e3a8-4c18-90af-d2d205d6bc8b
ALIQUOT188	71f5bda6-c482-4142-9e13-ae9ee4dc3afb	c3129edc-1783-4990-8092-9ccf47ff2dd6
ALIQUOT189	fc689cd4-44a8-4160-afb4-242bde29ec18	26663d5d-51bd-4f24-b4c1-ab126c59a535
ALIQUOT19	11f1276f-d829-43ff-b519-81e994e2e4fe	a73c1744-c790-4467-8a07-99c9430faf1a
ALIQUOT190	c6f03bd6-e8e1-4e41-a2ec-464188a3277f	1bdd8035-5e89-4e56-ba28-bdfbdd9f803c
ALIQUOT191	aaece851-ced6-4816-9cf2-2fa506f2bc79	aa07890d-f6a2-40dd-b132-34add476aa30
ALIQUOT192	d7ac181d-ce1b-4672-953e-aeff29615636	1fc64da5-73e3-4464-ba47-3f17cd2ee6b3
ALIQUOT193	0b2618b5-3ece-4655-b4ed-ed4b51ab6702	5003560e-0882-41d3-aa9a-947e98730d29
ALIQUOT194	ad6f1cc8-b339-454e-ba88-bf4b1a5f27c9	0503e9b4-10dd-4481-ae59-bc65d9855b36
ALIQUOT195	cf5c26cb-5a53-4663-bf10-a8ac74749569	0c9d5d95-5dc4-4694-ba40-12fd50ccfd1e
ALIQUOT196	775ec7b4-96c9-4246-b025-41b4981ea736	9f06ad72-390a-4137-b4f3-f06a92e3271d
ALIQUOT197	ad6f1cc8-b339-454e-ba88-bf4b1a5f27c9	52128aa5-e913-457d-82f0-1e17768b90b9
ALIQUOT199	c6f03bd6-e8e1-4e41-a2ec-464188a3277f	3b743c5e-9962-4ff1-8fa3-4def9ca466e8
ALIQUOT2	f5393eea-abad-4f59-a19d-4ac65bd0ad65	621bf8fb-db88-4088-be41-c8f6719de10b
ALIQUOT20	11f1276f-d829-43ff-b519-81e994e2e4fe	e73259e2-58b4-420d-bf4c-247f94642107
ALIQUOT200	c6f03bd6-e8e1-4e41-a2ec-464188a3277f	3e5c4dc0-be52-4137-a662-c1cd06ae7205
ALIQUOT202	6bec9fdd-64f1-4cf4-90e6-8a3610a6b641	88ecc672-5e8f-47bb-8dd2-21c028e797c9
ALIQUOT204	3e32e738-6c3c-413f-bb2b-8ab62b55c57c	1bcfcf85-1047-408b-9113-a5265913e146
ALIQUOT205	eee1adb4-f965-43a2-8037-ff706c37e0cc	b5a15814-5ca3-4a64-a335-7e2c1132e100
ALIQUOT206	e5cdafdf-d896-47e8-8de1-c27a3eeb4db8	bf9aef74-5765-4ac3-972a-e6e98880d292
ALIQUOT208	e7b173c2-b03c-4da3-9f20-59f922bb4f50	c34204ef-77d7-4675-ba0d-8df23f76e73d
ALIQUOT21	c12aeeeb-8b99-45cf-b41b-66d790da3f20	b1165861-75d7-45c3-baa5-1c2fdc180556
ALIQUOT211	ff87de39-5f94-4706-8d87-1aad2525874e	162006d7-fdfe-411e-bd50-371970cf6003
ALIQUOT212	51073092-c813-4fec-a104-8fff32e249b2	fa4a1c7c-46fb-4d44-a850-64fca862349a
ALIQUOT213	eee1adb4-f965-43a2-8037-ff706c37e0cc	7f385a64-6d1f-4655-9448-a4ced314005d
ALIQUOT215	f3aa1797-24fc-4fd1-a9f0-35acbc767562	0a964bc5-38fe-487e-8fee-860a09913318
ALIQUOT216	8e86e075-f718-4173-9d1e-a6c47fce1528	5f3340c2-8fe9-4dd0-9746-66709ea3fe93
ALIQUOT217	d7f95afc-d9d9-497e-b7ba-cdaec4d300b4	5165a00c-39a6-4c95-8b1d-9609e9069ad0
ALIQUOT218	eee1adb4-f965-43a2-8037-ff706c37e0cc	5703fb05-a854-462d-92c3-05aeea489f8a
ALIQUOT219	5d324f9f-87ce-454d-bfcd-2d7e38d52e92	29dbc70a-abbf-429e-9dc8-ea88ea75b482
ALIQUOT22	c12aeeeb-8b99-45cf-b41b-66d790da3f20	8528f679-2e97-439c-81ed-40e904397d6d
ALIQUOT220	34515919-3925-4349-ac41-2dabd824af90	626e3927-d5d7-4f3b-9b0e-0551e959f05a
ALIQUOT221	ec7df26c-62a3-41de-bb81-fde371433004	023d98ad-3200-421d-95b0-572947e2a5d7
ALIQUOT222	ceaa6c9a-bf8d-46a5-83eb-5925fce73b09	1fde7c44-118a-48ac-811a-11b8dd2f0dcb
ALIQUOT223	51ef4f43-6fb7-45c2-86fc-40c359af4ea8	5ad047b5-d479-479b-b376-5fd75f40d552
ALIQUOT224	57aeef7a-e0c6-4e53-90ce-c213c5263544	a5fb71d1-d47b-4200-a511-de0ee6ce0af1
ALIQUOT226	5931f374-24fc-4e51-9bc4-80f9cb9d0d91	756def88-ec9d-4673-9671-3631a0ea77a5
ALIQUOT227	eee1adb4-f965-43a2-8037-ff706c37e0cc	349a950b-e382-4426-9144-40e94d1340de
ALIQUOT25	ceaa6c9a-bf8d-46a5-83eb-5925fce73b09	0ed731af-c9ea-47e8-9328-5029063e0d50
ALIQUOT26	ceaa6c9a-bf8d-46a5-83eb-5925fce73b09	f93ddd92-9cc7-490e-af17-3d44aac00c39
ALIQUOT27	51073092-c813-4fec-a104-8fff32e249b2	5b6d30b6-ac02-485e-8149-c9471c1219d1
ALIQUOT28	51073092-c813-4fec-a104-8fff32e249b2	e5f5d6a8-6aa2-4c08-b7a1-e37cbed033d9
ALIQUOT3	4d8466c3-dcb1-491b-9856-b68cf8226648	6acf195c-b0e0-47ed-af66-85981ef3f7c1
ALIQUOT31	807178e3-e036-41d2-88e1-8d1504d806fc	4736b661-047a-4a28-b895-3f6fd14b5eea
ALIQUOT32	807178e3-e036-41d2-88e1-8d1504d806fc	aabfda66-afe6-484f-a48d-c5e528b758ce
ALIQUOT33	1d61175a-4878-43ba-b72a-1087bc002935	2ea15be5-23c7-446b-bb77-c858555093b9
ALIQUOT34	1d61175a-4878-43ba-b72a-1087bc002935	da303bd1-d450-4c0c-98be-1e86dff8b8e7
ALIQUOT35	3e32e738-6c3c-413f-bb2b-8ab62b55c57c	a4bbcdcf-fcbc-4fee-ae01-1ecb0ae5fe3c
ALIQUOT36	3e32e738-6c3c-413f-bb2b-8ab62b55c57c	1de993bf-9317-4098-81f0-82c4cae12e2b
ALIQUOT37	3e32e738-6c3c-413f-bb2b-8ab62b55c57c	fc9fce8e-2e15-4c8c-9a73-24756df83612
ALIQUOT38	5d324f9f-87ce-454d-bfcd-2d7e38d52e92	13e9169a-463c-489a-b826-bf4dd4621796
ALIQUOT39	5d324f9f-87ce-454d-bfcd-2d7e38d52e92	4bc23f0f-f596-4d41-98e0-975e5160711b
ALIQUOT4	4d8466c3-dcb1-491b-9856-b68cf8226648	5e60dc41-077a-47c6-8f9e-1e3f69246963
ALIQUOT40	5d324f9f-87ce-454d-bfcd-2d7e38d52e92	f986cdca-847f-49c6-bf59-43289dc2d523
ALIQUOT41	e7b173c2-b03c-4da3-9f20-59f922bb4f50	e7dadd40-10da-4f27-ae3e-979f081ad42e
ALIQUOT42	e7b173c2-b03c-4da3-9f20-59f922bb4f50	0aa24fa8-f0f9-4689-ac54-2235b687e0f3
ALIQUOT43	e7b173c2-b03c-4da3-9f20-59f922bb4f50	6e58753b-531c-483c-8864-aa07340e1fdb
ALIQUOT44	51ef4f43-6fb7-45c2-86fc-40c359af4ea8	70db8ee2-0b8e-4460-bb02-1163476094b0
ALIQUOT45	51ef4f43-6fb7-45c2-86fc-40c359af4ea8	0cf7278a-2d50-498c-a6ca-c63508c69ffb
ALIQUOT46	51ef4f43-6fb7-45c2-86fc-40c359af4ea8	5dabb9d1-458f-4210-9fce-dea821b872cd
ALIQUOT47	57aeef7a-e0c6-4e53-90ce-c213c5263544	68203e78-2b71-4fe3-9a89-e4275708a877
ALIQUOT48	57aeef7a-e0c6-4e53-90ce-c213c5263544	042c5e74-bcae-4794-8623-2b2f5aa7d68a
ALIQUOT49	57aeef7a-e0c6-4e53-90ce-c213c5263544	ff354309-14a1-46d5-8270-ad678d281d3e
ALIQUOT5	4d8466c3-dcb1-491b-9856-b68cf8226648	f72ea9c2-d043-40ad-9186-74d9ebc170bc
ALIQUOT50	6bec9fdd-64f1-4cf4-90e6-8a3610a6b641	0b71a451-c8fa-4636-9d46-a4be626da860
ALIQUOT51	6bec9fdd-64f1-4cf4-90e6-8a3610a6b641	5471a7d7-bfa0-4b96-9e42-2eda52dd0e2f
ALIQUOT52	6bec9fdd-64f1-4cf4-90e6-8a3610a6b641	25b32ac2-df24-4027-80c5-35d0daec1e84
ALIQUOT53	cf5c26cb-5a53-4663-bf10-a8ac74749569	a1d0fc28-0862-457c-b24f-58cb84aa4720
ALIQUOT54	cf5c26cb-5a53-4663-bf10-a8ac74749569	2a664573-6f77-4865-915c-81f17944c8b4
ALIQUOT55	cf5c26cb-5a53-4663-bf10-a8ac74749569	5e26b451-24ac-4bbb-918f-c8cb0fabe1f6
ALIQUOT56	f15e79b7-52b4-44df-8ddb-b3bbc65c50b3	9f2eba73-ca69-497d-b259-4e6741b59f0d
ALIQUOT57	f15e79b7-52b4-44df-8ddb-b3bbc65c50b3	f674f706-af71-42b4-abac-9ba3a3ca3a7a
ALIQUOT58	f15e79b7-52b4-44df-8ddb-b3bbc65c50b3	b44b2945-8e2e-44eb-aeac-05e5d21211d8
ALIQUOT59	d7f95afc-d9d9-497e-b7ba-cdaec4d300b4	48697995-6e2f-4742-bd73-a8f5c3e684bd
ALIQUOT6	cecdd55a-4d5c-4050-8ff5-b89305078289	9704e823-51dc-4496-81b2-75f6dd88284f
ALIQUOT60	d7f95afc-d9d9-497e-b7ba-cdaec4d300b4	99e65c76-4c44-4b31-b003-0fb1cf4213f3
ALIQUOT61	d7f95afc-d9d9-497e-b7ba-cdaec4d300b4	a17a41eb-f95a-48d5-9f96-9d3111e73394
ALIQUOT62	cecdd55a-4d5c-4050-8ff5-b89305078289	c33e1979-8612-4225-bc94-36b6dc5c58b5
ALIQUOT63	775ec7b4-96c9-4246-b025-41b4981ea736	d2d27cc0-b511-4c08-a280-3844ea42c285
ALIQUOT64	490344a3-9367-42cb-b109-8562eed90bdf	1f29c94d-cc41-4515-baf9-4efb974ec217
ALIQUOT65	ec7df26c-62a3-41de-bb81-fde371433004	baaf5f16-8190-4acf-86e5-b58ba9891dc6
ALIQUOT66	f5393eea-abad-4f59-a19d-4ac65bd0ad65	18f6a19d-ce53-49f3-b1cb-035a0c2549db
ALIQUOT67	71f5bda6-c482-4142-9e13-ae9ee4dc3afb	2f8df0bb-2ea0-45cf-bc9b-c155e5f76448
ALIQUOT68	0199d671-0b2d-4673-9a3a-8df12e0a17cd	e41c5e4a-4c2e-4077-bdd9-0bf6bb38c0c3
ALIQUOT69	ad6f1cc8-b339-454e-ba88-bf4b1a5f27c9	35ffbaea-301a-4632-bfa4-6b0e5c01b470
ALIQUOT7	cecdd55a-4d5c-4050-8ff5-b89305078289	811145cf-43fa-4de6-8a7a-0d62c9770bfa
ALIQUOT71	fc689cd4-44a8-4160-afb4-242bde29ec18	cc59f119-88d5-4af4-ab51-6daa45d04234
ALIQUOT72	c12aeeeb-8b99-45cf-b41b-66d790da3f20	ec2bd50f-bf38-43c4-88c0-0fd1e8587c10
ALIQUOT76	5cba90b4-5473-4826-a945-c50f2663e252	1e9f7bcf-49f6-407d-9902-22980728375e
ALIQUOT77	ceaa6c9a-bf8d-46a5-83eb-5925fce73b09	bee9b196-eb01-41d5-a15a-f7d44ce344a0
ALIQUOT78	1c49e2cd-e5f3-4fbd-a8f0-4714ed8fb818	c164413e-3265-4d1d-93d9-8b97a4059a3f
ALIQUOT79	51073092-c813-4fec-a104-8fff32e249b2	373dd0c1-c637-41bb-beee-da0923e61780
ALIQUOT8	775ec7b4-96c9-4246-b025-41b4981ea736	5361b1ae-1c6d-48a8-863f-e8fcc33d5d4d
ALIQUOT80	959af07a-3958-4487-9fce-32cd99f2b9f9	716a7eed-5192-4121-9d06-c893c7f32ba6
ALIQUOT81	5931f374-24fc-4e51-9bc4-80f9cb9d0d91	026186cf-b7f6-4965-8a5f-90a1461023e7
ALIQUOT83	6e3a4c8a-3fa1-4869-837c-793659f9519f	48029b91-5d47-4bdc-b10f-0c572d9964bb
ALIQUOT84	239488c1-a7c6-4588-a573-93288f69bd8c	5678da56-054c-4326-8f3c-6492c63f6eb9
ALIQUOT85	427ab72d-18a8-4d03-8583-5d2fbd9dc2ef	796fe41f-a8a4-4279-90a2-19d127ed6c7f
ALIQUOT86	807178e3-e036-41d2-88e1-8d1504d806fc	e8caa200-c92d-4b7c-8db4-1cc2a7cded5e
ALIQUOT87	1d61175a-4878-43ba-b72a-1087bc002935	3da70705-30d1-4872-9d6a-0e72d914ec5f
ALIQUOT88	b1586dad-28e3-45dd-a37d-949601f2663f	7944bc23-7603-4e61-8bcb-1b1da732fe6d
ALIQUOT89	723faa4e-7b3c-49bc-96c6-23ace122af94	44dc0b05-6860-4893-a0df-8ed58d98fe03
ALIQUOT9	775ec7b4-96c9-4246-b025-41b4981ea736	a76a7ddc-c45c-459f-9656-090a0b0607da
ALIQUOT90	650c6541-6187-48ac-a11c-0c9e68ba8401	da844991-fafb-46e2-b136-69de1af3fb70
ALIQUOT91	78e47d67-2ce1-4e41-bb4f-5768f7aa6eb0	d761c067-6040-43d3-abc7-90b06419e766
ALIQUOT92	f7a6e992-9f97-4387-85c6-18da46a97aac	beafb5b8-a70b-43e5-86cb-d41ca2e75481
ALIQUOT93	eee1adb4-f965-43a2-8037-ff706c37e0cc	55e8b6ba-b99a-4e39-b66a-2a8ccae4ee5d
ALIQUOT94	eee1adb4-f965-43a2-8037-ff706c37e0cc	16268ca4-0c11-452f-8401-dfa1a6244790
ALIQUOT95	eee1adb4-f965-43a2-8037-ff706c37e0cc	08ca3ed6-0fb1-4633-81be-69d6e4d02924
ALIQUOT96	eee1adb4-f965-43a2-8037-ff706c37e0cc	b9a1f553-38ac-4251-b41b-79c5673c31d1
ALIQUOT97	c6f03bd6-e8e1-4e41-a2ec-464188a3277f	9400dbfa-89b2-47ee-a350-e6c2536d138f
ALIQUOT98	c6f03bd6-e8e1-4e41-a2ec-464188a3277f	6613fe3e-549f-4c57-a859-8e8f35cb4fff
ALIQUOT99	c6f03bd6-e8e1-4e41-a2ec-464188a3277f	80abd46a-37d9-4531-be39-6890e22dac1a
'''




def main(args):

    if len(args) != 3:
        print(" ")
        print(" Usage : {} <damaged_tsv> <repaired_tsv>".format(args[0]))
        return

    repair_dict = {}
    for line in repairs.splitlines():
        toks = line.split('\t')
        aliq_id = toks[0]
        repair_dict[aliq_id] = toks

    #
    # pull info out of each row:
    #

    case_dict = {}
    with open(args[1], mode='r') as tsvfile:
        reader = csv.reader(tsvfile, delimiter='\t')
        for row in reader:
            case_id = row[2]
            if case_id in case_dict:
                case = case_dict[case_id]
                if "PORTION" in row[11]:
                    case[11] = row[11]
                    case[10] = row[10]
                elif "ANALYTE" in row[13]:
                    case[13] = row[13]
                    case[12] = row[12]
                    case[15] = row[13].replace("ANALYTE", "ALIQUOT")
                    repair_info = repair_dict[case[15]]
                    if repair_info[1] != case_id:
                        raise Exception
                    case[14] = repair_info[2]
                else:
                    raise Exception
            else:
                case = row.copy()
                case_dict[case_id] = case


    with open(args[2], mode='w+') as normfile:
        for k, v in case_dict.items():
            first = True
            for field in v:
                if not first:
                    normfile.write("\t")
                first = False
                normfile.write(field)
            normfile.write("\n")


if __name__ == "__main__":
    main(sys.argv)