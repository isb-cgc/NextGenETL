<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cda_bq_etl.data_helpers &#8212; ISB-CGC ETL 1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-cda_bq_etl.data_helpers">
<span id="cda-bq-etl-data-helpers"></span><h1>cda_bq_etl.data_helpers<a class="headerlink" href="#module-cda_bq_etl.data_helpers" title="Link to this heading">¶</a></h1>
<p>Normalize and transform raw data.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.aggregate_column_data_types_tsv" title="cda_bq_etl.data_helpers.aggregate_column_data_types_tsv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">aggregate_column_data_types_tsv</span></code></a>(tsv_fp, ...)</p></td>
<td><p>Open tsv file and aggregate data types for each column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.check_value_type" title="cda_bq_etl.data_helpers.check_value_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_value_type</span></code></a>(value)</p></td>
<td><p>Check value for corresponding BigQuery type. Evaluates the following BigQuery column data types:</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.create_normalized_tsv" title="cda_bq_etl.data_helpers.create_normalized_tsv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_normalized_tsv</span></code></a>(raw_tsv_fp, ...)</p></td>
<td><p>Opens a raw tsv file, normalizes its data, then writes to new tsv file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.create_tsv_row" title="cda_bq_etl.data_helpers.create_tsv_row"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_tsv_row</span></code></a>(row_list[, null_marker])</p></td>
<td><p>Convert list of row values into a tab-delimited string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.get_column_list_tsv" title="cda_bq_etl.data_helpers.get_column_list_tsv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_column_list_tsv</span></code></a>([header_list, tsv_fp, ...])</p></td>
<td><p>Return a list of column headers using header_list OR using a header_row index to retrieve column names from tsv_fp.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.initialize_logging" title="cda_bq_etl.data_helpers.initialize_logging"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_logging</span></code></a>(log_filepath[, name, ...])</p></td>
<td><p>Initialize logging.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.is_int_value" title="cda_bq_etl.data_helpers.is_int_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_int_value</span></code></a>(value)</p></td>
<td><p>Verify whether this value is of int type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.json_datetime_to_str_converter" title="cda_bq_etl.data_helpers.json_datetime_to_str_converter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">json_datetime_to_str_converter</span></code></a>(datetime_obj)</p></td>
<td><p>Convert python datetime object to string (necessary for json serialization).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.normalize_flat_json_values" title="cda_bq_etl.data_helpers.normalize_flat_json_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize_flat_json_values</span></code></a>(records)</p></td>
<td><p>Normalize flat (non-nested) JSON values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.normalize_value" title="cda_bq_etl.data_helpers.normalize_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize_value</span></code></a>(value[, is_tsv])</p></td>
<td><p>If value is string, but is NoneType-like or boolean-like, then converts to correct form (None, True, False).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.recursively_detect_object_structures" title="cda_bq_etl.data_helpers.recursively_detect_object_structures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recursively_detect_object_structures</span></code></a>(nested_obj)</p></td>
<td><p>Traverse a dict or list of objects, analyzing the structure.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.resolve_type_conflict" title="cda_bq_etl.data_helpers.resolve_type_conflict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resolve_type_conflict</span></code></a>(field, types_set)</p></td>
<td><p>Resolve BigQuery column data type precedence, where multiple types are detected.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.resolve_type_conflicts" title="cda_bq_etl.data_helpers.resolve_type_conflicts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resolve_type_conflicts</span></code></a>(types_dict)</p></td>
<td><p>Iteratively resolve data type conflicts for non-nested type dicts (e.g. if there is more than one data type found, select the superseding type).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.write_list_to_jsonl" title="cda_bq_etl.data_helpers.write_list_to_jsonl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_list_to_jsonl</span></code></a>(jsonl_fp, json_obj_list)</p></td>
<td><p>Create a jsonl file for uploading data into BigQuery from a list&lt;dict&gt; obj.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cda_bq_etl.data_helpers.write_list_to_jsonl_and_upload" title="cda_bq_etl.data_helpers.write_list_to_jsonl_and_upload"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_list_to_jsonl_and_upload</span></code></a>(params, ...)</p></td>
<td><p>Write joined_record_list to file name specified by prefix and uploads to scratch Google Cloud bucket.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.aggregate_column_data_types_tsv">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">aggregate_column_data_types_tsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tsv_fp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.aggregate_column_data_types_tsv" title="Link to this definition">¶</a></dt>
<dd><p>Open tsv file and aggregate data types for each column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsv_fp</strong> (<em>str</em>) – tsv dataset filepath used to analyze the data types</p></li>
<li><p><strong>column_headers</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – list of ordered column headers</p></li>
<li><p><strong>skip_rows</strong> (<em>int</em>) – number of (header) rows to skip before starting analysis</p></li>
<li><p><strong>sample_interval</strong> (<em>int</em>) – sampling interval, used to skip rows in large datasets; defaults to checking every row
ex.: sample_interval == 10 will sample every 10th row</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict of column keys, with value sets representing all data types found for that column</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, set[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.check_value_type">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">check_value_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.check_value_type" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Check value for corresponding BigQuery type. Evaluates the following BigQuery column data types:</dt><dd><ul class="simple">
<li><p>datetime formats: DATE, TIME, TIMESTAMP</p></li>
<li><p>number formats: INT64, FLOAT64, NUMERIC</p></li>
<li><p>misc formats: STRING, BOOL, ARRAY, RECORD</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Any</em>) – value on which to perform data type analysis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data type in BigQuery Standard SQL format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.create_normalized_tsv">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">create_normalized_tsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_tsv_fp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_tsv_fp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cda_bq_etl.data_helpers.create_normalized_tsv" title="Link to this definition">¶</a></dt>
<dd><p>Opens a raw tsv file, normalizes its data, then writes to new tsv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raw_tsv_fp</strong> (<em>str</em>) – path to non-normalized data file</p></li>
<li><p><strong>normalized_tsv_fp</strong> (<em>str</em>) – destination file for normalized data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.create_tsv_row">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">create_tsv_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">null_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'None'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.create_tsv_row" title="Link to this definition">¶</a></dt>
<dd><p>Convert list of row values into a tab-delimited string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row_list</strong> (<em>list</em><em>[</em><em>Any</em><em>]</em>) – list of row values for conversion</p></li>
<li><p><strong>null_marker</strong> (<em>str</em>) – Value to write to string for nulls</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tab-delimited string representation of row_list</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.get_column_list_tsv">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">get_column_list_tsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsv_fp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_row_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.get_column_list_tsv" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return a list of column headers using header_list OR using a header_row index to retrieve column names from tsv_fp.</dt><dd><p>NOTE: Specifying both header_list and header_row in parent function triggers a fatal error.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header_list</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Optional ordered list of column headers corresponding to columns in dataset tsv file</p></li>
<li><p><strong>tsv_fp</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional string filepath; provided if column names are being obtained directly from tsv header</p></li>
<li><p><strong>header_row_index</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Optional header row index, if deriving column names from tsv file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of columns with BQ-compatible names</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.initialize_logging">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">initialize_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'base_script'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emit_to_console</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Logger</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.initialize_logging" title="Link to this definition">¶</a></dt>
<dd><p>Initialize logging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_filepath</strong> (<em>str</em>) – Path to log file</p></li>
<li><p><strong>name</strong> (<em>str</em>) – logger name, which specifies which file the script is executing (default: ‘base_script’)</p></li>
<li><p><strong>emit_to_console</strong> (<em>bool</em>) – If True, output to logger to console, otherwise only outputs to log file (default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logger object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.is_int_value">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">is_int_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.is_int_value" title="Link to this definition">¶</a></dt>
<dd><p>Verify whether this value is of int type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>int</em>) – the value to evaluate</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if value is int type, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.json_datetime_to_str_converter">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">json_datetime_to_str_converter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datetime_obj:</span> <span class="pre">&lt;module</span> <span class="pre">'datetime'</span> <span class="pre">from</span> <span class="pre">'/usr/local/Cellar/python&#64;3.11/3.11.13/Frameworks/Python.framework/Versions/3.11/lib/python3.11/datetime.py'&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.json_datetime_to_str_converter" title="Link to this definition">¶</a></dt>
<dd><p>Convert python datetime object to string (necessary for json serialization).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>datetime_obj</strong> (<em>datetime</em>) – python datetime object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>datetime cast as string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.normalize_flat_json_values">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">normalize_flat_json_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">records</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.normalize_flat_json_values" title="Link to this definition">¶</a></dt>
<dd><p>Normalize flat (non-nested) JSON values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>records</strong> (<em>JSONList</em>) – JSONList of records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JSONList of normalized records</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>JSONList</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.normalize_value">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">normalize_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_tsv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.normalize_value" title="Link to this definition">¶</a></dt>
<dd><p>If value is string, but is NoneType-like or boolean-like, then converts to correct form (None, True, False).
If value is a trivial float (e.g. 100.0), converts to int. This is safe to do, because if any of the values in a
given column end up being floats, BigQuery will re-convert the ints back into float format.
otherwise returns original value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>Any</em>) – value to convert</p></li>
<li><p><strong>is_tsv</strong> (<em>bool</em>) – If True, null value is converted to a TSV-safe form (empty string); otherwise converted to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>normalized (or original) value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.recursively_detect_object_structures">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">recursively_detect_object_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nested_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.recursively_detect_object_structures" title="Link to this definition">¶</a></dt>
<dd><p>Traverse a dict or list of objects, analyzing the structure. Order not guaranteed (if anything, it’ll be
backwards)–Not for use with TSV data. Works for arbitrary nesting, even if object structure varies from record to
record; use for lists, dicts, or any combination therein.
If nested_obj is a list, function will traverse every record in order to find all possible fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nested_obj</strong> (<em>JSONList</em><em> | </em><em>RowDict</em>) – object to traverse</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data types dict–key is the field name, value is the set of BigQuery column data types returned</p>
</dd>
</dl>
<p>when analyzing data using check_value_type ({&lt;field_name&gt;: {&lt;data_type_set&gt;}})
:rtype: JSONList | RowDict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.resolve_type_conflict">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">resolve_type_conflict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types_set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.resolve_type_conflict" title="Link to this definition">¶</a></dt>
<dd><p>Resolve BigQuery column data type precedence, where multiple types are detected. Rules for type conversion based on
BigQuery’s implicit conversion behavior.
See <a class="reference external" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_rules#coercion">https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_rules#coercion</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>str</em>) – field name</p></li>
<li><p><strong>types_set</strong> (<em>set</em><em>[</em><em>str</em><em>] </em><em>| </em><em>ColumnTypes</em>) – Set of BigQuery data types in string format</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>BigQuery data type with the highest precedence</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.resolve_type_conflicts">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">resolve_type_conflicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#cda_bq_etl.data_helpers.resolve_type_conflicts" title="Link to this definition">¶</a></dt>
<dd><p>Iteratively resolve data type conflicts for non-nested type dicts (e.g. if there is more than one data type found,
select the superseding type).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>types_dict</strong> (<em>dict {str: set}</em>) – dict containing columns and all detected data types</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict containing the column name and its BigQuery data type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.write_list_to_jsonl">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">write_list_to_jsonl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jsonl_fp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_obj_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cda_bq_etl.data_helpers.write_list_to_jsonl" title="Link to this definition">¶</a></dt>
<dd><p>Create a jsonl file for uploading data into BigQuery from a list&lt;dict&gt; obj.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jsonl_fp</strong> (<em>str</em>) – local VM jsonl filepath</p></li>
<li><p><strong>json_obj_list</strong> (<em>JSONList</em>) – list of dicts representing json objects</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – ‘a’ if appending to a file that’s being built iteratively;
‘w’ if file data is written in a single call to the function
(in which case any existing data is overwritten)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cda_bq_etl.data_helpers.write_list_to_jsonl_and_upload">
<span class="sig-prename descclassname"><span class="pre">cda_bq_etl.data_helpers.</span></span><span class="sig-name descname"><span class="pre">write_list_to_jsonl_and_upload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">release</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cda_bq_etl.data_helpers.write_list_to_jsonl_and_upload" title="Link to this definition">¶</a></dt>
<dd><p>Write joined_record_list to file name specified by prefix and uploads to scratch Google Cloud bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – params supplied in yaml config</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – string representing base file name (release string is appended to generate filename)</p></li>
<li><p><strong>record_list</strong> (<em>JSONList</em>) – list of record objects to insert into jsonl file</p></li>
<li><p><strong>release</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional custom release, if different from what is provided in shared config yaml</p></li>
<li><p><strong>local_filepath</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – VM path where jsonl file is stored prior to upload</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">cda_bq_etl.data_helpers</a><ul>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.aggregate_column_data_types_tsv"><code class="docutils literal notranslate"><span class="pre">aggregate_column_data_types_tsv()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.check_value_type"><code class="docutils literal notranslate"><span class="pre">check_value_type()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.create_normalized_tsv"><code class="docutils literal notranslate"><span class="pre">create_normalized_tsv()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.create_tsv_row"><code class="docutils literal notranslate"><span class="pre">create_tsv_row()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.get_column_list_tsv"><code class="docutils literal notranslate"><span class="pre">get_column_list_tsv()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.initialize_logging"><code class="docutils literal notranslate"><span class="pre">initialize_logging()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.is_int_value"><code class="docutils literal notranslate"><span class="pre">is_int_value()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.json_datetime_to_str_converter"><code class="docutils literal notranslate"><span class="pre">json_datetime_to_str_converter()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.normalize_flat_json_values"><code class="docutils literal notranslate"><span class="pre">normalize_flat_json_values()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.normalize_value"><code class="docutils literal notranslate"><span class="pre">normalize_value()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.recursively_detect_object_structures"><code class="docutils literal notranslate"><span class="pre">recursively_detect_object_structures()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.resolve_type_conflict"><code class="docutils literal notranslate"><span class="pre">resolve_type_conflict()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.resolve_type_conflicts"><code class="docutils literal notranslate"><span class="pre">resolve_type_conflicts()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.write_list_to_jsonl"><code class="docutils literal notranslate"><span class="pre">write_list_to_jsonl()</span></code></a></li>
<li><a class="reference internal" href="#cda_bq_etl.data_helpers.write_list_to_jsonl_and_upload"><code class="docutils literal notranslate"><span class="pre">write_list_to_jsonl_and_upload()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, ISB-CGC.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/generated/cda_bq_etl.data_helpers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>